(self.webpackChunkcontrib_stats=self.webpackChunkcontrib_stats||[]).push([[407],{5066:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return q}});var r=t(885),s=t(2791),a="Dashboard_Dashboard__JhvwZ",o=t(712),i=t(3279),l=t(7022);function c(e,n){var t=(0,s.useRef)(!0);(0,s.useEffect)((function(){if(!t.current)return e();t.current=!1}),n)}var u=t(4942),h=t(1413),d=t(5313),x=t(9743),p=t(2677),m=t(3161),f=t(6157),j=t(4849),Z=t(184),g=function(e){var n=e.isLoading,t=e.contributors,a=(0,s.useState)({repo:"",authToken:"",contributorId:""}),o=(0,r.Z)(a,2),i=o[0],g=o[1],b=(0,s.useState)(!1),v=(0,r.Z)(b,2),C=v[0],T=v[1];c((function(){return e.handleAuthTokenUpdate(i.authToken)}),[i.authToken]),c((function(){return w(i)}),[i]);var k=function(e){var n=e.target.name,t=e.target.value;g((function(e){return(0,h.Z)((0,h.Z)({},e),{},(0,u.Z)({},n,t))}))},w=function(e){e.repo&&e.authToken&&e.contributorId?T(!0):T(!1)};return(0,Z.jsx)(l.Z,{children:(0,Z.jsx)(d.Z,{onSubmit:function(n){e.handleFormSubmit(n,i)},children:(0,Z.jsxs)(x.Z,{children:[(0,Z.jsx)(p.Z,{lg:{span:3,offset:1},children:(0,Z.jsx)(d.Z.Group,{children:(0,Z.jsx)(d.Z.Control,{type:"password",name:"authToken","aria-describedby":"Auth Token",placeholder:"Personal Access Token",value:i.authToken,onChange:k})})}),(0,Z.jsx)(p.Z,{lg:{span:3},children:(0,Z.jsx)(d.Z.Group,{children:(0,Z.jsx)(d.Z.Control,{type:"text",name:"repo","aria-describedby":"owner and repo",placeholder:"repo owner/name",value:i.repo,onChange:k})})}),(0,Z.jsx)(p.Z,{lg:{span:3},children:(0,Z.jsx)(d.Z.Group,{children:(0,Z.jsxs)(m.Z,{children:[(0,Z.jsxs)(d.Z.Select,{name:"contributorId","aria-label":"Contributor select",onChange:k,value:i.contributorId,children:[(0,Z.jsx)("option",{children:"Select Contributor"}),t.map((function(e){return(0,Z.jsx)("option",{value:e,children:e},e)}))]}),(0,Z.jsx)(f.Z,{onClick:function(n){e.handleFetchUsers(n,i.repo)},variant:"outline-secondary",id:"button-addon2",children:"Get Users"})]})})}),(0,Z.jsx)(p.Z,{lg:{span:2},children:(0,Z.jsx)(d.Z.Group,{children:(0,Z.jsx)(f.Z,{type:"submit",variant:"outline-secondary",disabled:n||!C,children:n?(0,Z.jsx)(j.Z,{as:"span",size:"sm",animation:"border",variant:"secondary"}):"Analyze"})})})]})})})},b="DashboardStats_statCard__ItfwI",v=t(2144),C=t(5134),T=t.n(C),k=s.memo((function(e){var n=e.stats;return(0,Z.jsxs)(l.Z,{children:[(0,Z.jsxs)(x.Z,{children:[(0,Z.jsx)(p.Z,{lg:{span:3,offset:1},children:(0,Z.jsx)(v.Z,{text:"light",className:b,children:(0,Z.jsxs)(v.Z.Body,{children:[(0,Z.jsx)(v.Z.Text,{children:"Pull-requests merged"}),(0,Z.jsx)("h2",{children:(0,Z.jsx)(T(),{animateToNumber:n.totalPulls})})]})})}),(0,Z.jsx)(p.Z,{lg:{span:4},children:(0,Z.jsx)(v.Z,{text:"light",className:b,children:(0,Z.jsxs)(v.Z.Body,{children:[(0,Z.jsx)(v.Z.Text,{children:"Pull-requests with no changes requested"}),(0,Z.jsx)("h2",{children:(0,Z.jsx)(T(),{animateToNumber:n.pullsWithNoChanges})})]})})}),(0,Z.jsx)(p.Z,{lg:{span:3},children:(0,Z.jsx)(v.Z,{text:"light",className:b,children:(0,Z.jsxs)(v.Z.Body,{children:[(0,Z.jsx)(v.Z.Text,{children:"Highest Comments on a PR"}),(0,Z.jsx)("h2",{children:(0,Z.jsx)(T(),{animateToNumber:n.highestCommentsOnPR})})]})})})]}),(0,Z.jsxs)(x.Z,{children:[(0,Z.jsx)(p.Z,{lg:{span:5,offset:1},children:(0,Z.jsx)(v.Z,{text:"light",className:b,children:(0,Z.jsxs)(v.Z.Body,{children:[(0,Z.jsx)(v.Z.Text,{children:"Avg. comments per pull-request"}),(0,Z.jsx)("h2",{children:(0,Z.jsx)(T(),{animateToNumber:n.avgComments})})]})})}),(0,Z.jsx)(p.Z,{lg:{span:5},children:(0,Z.jsx)(v.Z,{text:"light",className:b,children:(0,Z.jsxs)(v.Z.Body,{children:[(0,Z.jsx)(v.Z.Text,{children:"Avg. time between PR creation and merge"}),(0,Z.jsxs)("h2",{className:"d-flex",children:[(0,Z.jsx)(T(),{includeComma:!0,animateToNumber:n.avgOpenToCloseInMins}),(0,Z.jsx)("span",{children:"\xa0hrs"})]})]})})})]})]})})),w=t(2591),_="MetricsTable_metricsSection__W5NE6",N="MetricsTable_tableWrapper__xNH1n",y=s.memo((function(e){var n=e.metrics;return(0,Z.jsx)(l.Z,{className:_,children:(0,Z.jsxs)(x.Z,{children:[(0,Z.jsx)(p.Z,{lg:{span:11,offset:1},children:(0,Z.jsx)("h5",{children:"Weekly Contribution Break-down"})}),(0,Z.jsx)(p.Z,{className:N,lg:{span:10,offset:1},children:(0,Z.jsxs)(w.Z,{striped:!0,hover:!0,children:[(0,Z.jsx)("thead",{children:(0,Z.jsxs)("tr",{children:[(0,Z.jsx)("th",{children:"Week #"}),(0,Z.jsx)("th",{children:"Lines Added"}),(0,Z.jsx)("th",{children:"Lines Removed"}),(0,Z.jsx)("th",{children:"Commits"})]})}),(0,Z.jsx)("tbody",{children:n.map((function(e,n){return(0,Z.jsxs)("tr",{children:[(0,Z.jsx)("td",{children:new Date(1e3*e.w).toLocaleDateString()}),(0,Z.jsx)("td",{children:e.a}),(0,Z.jsx)("td",{children:e.d}),(0,Z.jsx)("td",{children:e.c})]},n)}))})]})})]})})})),S=function(e,n,t,r){var s=[],a="q="+encodeURIComponent("is:pr is:closed repo:".concat(t.repo," author:").concat(t.contributorId));e.request("GET /search/issues?".concat(a,"&per_page=100")).then((function(e){s=(s=e.data&&e.data.items).filter((function(e){return function(e,n){return Date.parse(n)>=e||!1}(n,e.created_at)})),r(s)}))},D=function(e,n,t){var r,s,a,o,i=(r=e.length,s=n.flat().length,Math.round(s/r)),l=function(e){var n=[],t=0;return e.forEach((function(e){var t=Date.parse(e.created_at),r=(Date.parse(e.closed_at)-t)/36e5;n.push(r)})),n.length>0&&(t=n.reduce((function(e,n){return e+n}))),Math.round(t/n.length)}(e),c=(a=e.length,o=n.length,a-o),u=function(e){var n=0;return e.map((function(e){return e.length})).forEach((function(e){e>n&&(n=e)})),n}(n);t({totalPulls:e.length,avgComments:i,avgOpenToCloseInMins:l,pullsWithNoChanges:c,highestCommentsOnPR:u})},I=new o.vd,P=s.memo((function(){var e=new Date;e.setDate(1),e.setMonth(e.getMonth()-2);var n=Number(e),t=(0,s.useState)([]),u=(0,r.Z)(t,2),h=u[0],d=u[1],x=(0,s.useState)(!1),p=(0,r.Z)(x,2),m=p[0],f=p[1],j=(0,s.useState)([]),b=(0,r.Z)(j,2),v=b[0],C=b[1],T=(0,s.useState)([]),w=(0,r.Z)(T,2),_=w[0],N=w[1],P=(0,s.useState)([]),q=(0,r.Z)(P,2),E=q[0],G=q[1],M=(0,s.useState)({totalPulls:0,avgOpenToCloseInMins:0,avgComments:0,pullsWithNoChanges:0,highestCommentsOnPR:0}),A=(0,r.Z)(M,2),R=A[0],B=A[1];c((function(){return function(e,n,t,r){var s=[],a=[];n.forEach((function(n){return s.push(e.request("GET /repos/{owner}/{repo}/pulls/{pull_number}/comments",{owner:"infer-ai",repo:"idc-portal-ui",pull_number:n.number}).then((function(e){e.data&&e.data.length>0&&a.push(e.data.filter((function(e){return function(e){return e.user&&"gopalanaika"!==e.user.login}(e)})))})))})),Promise.all(s).then((function(){return r(a)})).finally((function(){return t(!1)}))}(I,v,f,G)}),[v]),c((function(){return D(v,E,B)}),[E]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(i.Z,{bg:"dark",variant:"dark",children:(0,Z.jsxs)(l.Z,{children:[(0,Z.jsx)(i.Z.Brand,{href:"#home",children:"Contributor Stats"}),(0,Z.jsxs)(i.Z.Text,{children:["Computed from: ",e.toDateString()]})]})}),(0,Z.jsxs)(l.Z,{className:a,"data-testid":"Dashboard",fluid:!0,children:[(0,Z.jsx)(g,{handleAuthTokenUpdate:function(e){I=new o.vd({auth:e})},contributors:h,handleFetchUsers:function(e,n){!function(e,n,t,r){e.request("GET /repos/{owner}/{repo}/collaborators?per_page=100",{owner:n.split("/")[0],repo:n.split("/")[1]}).then((function(e){var n=e.data;n=n.map((function(e){return e.login})),r(n)})).finally((function(){return t(!1)}))}(I,n,f,d)},isLoading:m,handleFormSubmit:function(e,t){e.preventDefault(),f(!0),S(I,n,t,C),function(e,n){var t=e.repo,r=e.contributorId;I.request("GET /repos/{owner}/{repo}/stats/contributors",{owner:t.split("/")[0],repo:t.split("/")[1]}).then((function(e){var t=e.data.find((function(e){return e.author&&e.author.login===r})).weeks.slice(-12);n(t)}))}(t,N)}}),(0,Z.jsx)(k,{stats:R}),(0,Z.jsx)(y,{metrics:_})]})]})})),q=P},5696:function(){}}]);
//# sourceMappingURL=407.eb970a65.chunk.js.map